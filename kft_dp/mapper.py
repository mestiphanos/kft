import difflib        
def region_dictionary(self):
    return ['Dire Dawa',
     'Amhara',
     'Tigray',
     'Harari',
     'Sidama',
     'Benishangul_Gumuz',
     'Somali',
     'South_West',
     'Afar',
     'Gambela',
     'Southern_Nations',
     'Addis Ababa',
     'Oromia']
    
def woreda_dictionary():
    return ['ታህታይ አዲያቦ', 
'ላዕላይ አዲያቦ',
'መደባይ ዛና',
'ታህታይ ቆራሮ',
'አስገደ ፅምብላ' ,
'ፀለምቲ', 
'ሽሬ እንደስላሴ',
'ሽሬ',
'ሽራሮ','መረብለኸ', 
'አሂፈሮም', 
'ወርዒ ለኸ', 
'አድዋ', 
'ላዕላይ ማይጨው', 
'ታህታይ ማይጨው', 
'ናዕደር ዓዲት', 
'ቆላ ተምቤን', 
'ደጋ ተምቤን',
'ታኩዋ አበርገለ', 
'አቢ አዲ',
'አድዋ',
'አክሱም''ጉሎ መኸዳ',
'ኢሮብ',
'ሳዕሲዕ ፃዕዳአምባ',
'ገንታ አፈሹም',
'ሐውዜን',
'ኪልቴ አውላሎ',
'አፅቢ ወንበርታ',
'አዲግራት',
'ውቅሮ','ሲሐርቲ ሳምሪ',
'እንደርታ',
'ሕንጣሎ ዋጅራት',
'ኣላጀ' ,
'እንዳመሆኒ',
'ራያና አዘቦ'
'አላማጣ',
'ኦፍላ',
'ማይጨው',
'ኮረም',
'አላማጣ','ካፍታ ሁመራ',
'ወልቃት',
'ጸገዴ',
'ሁመራ','ደበብ ወረዳ' 
'ሰሜን ወረዳ','ዱብቲ','ኤሊዳር' ,
'አሳይታ',
'አፋምቦ', 
'ሚሌ', 
'ጭፍራ',
'ቆሪ','ኢረብቲ',
'ኮነባ',
'ኣብዓላ',
'መጋሊ',
'በራህሌ',
'ዳሎል',
'አፍዴራ','አሚባራ',
'አዋሽ ፈንታሌ',
'ገዋኔ',
'ዱለቻ',
'ቡሬ ሙዳይቱ',
'አርጎባ', 'አውራ',
'ዕዋ',
'ቴሩ',
'ያሎ',
'ጎሊና','ተላላክ',
'ሱሙ ሮቢ',
'ደዌ',
'ዳሊፋጊ',
'ሀደል ኢሊ','ኣዲ አርቃይ', 
'በየዳ',
'ጃናሞራ',
'ደባርቅ',
'ዳባት'
'ምዕራብ አርማጮ'
'ፀገዴ'
'ላይ አርማጭሆ'
'ወገራ',
'ጎንደር ዙሪያ',
'ደምቢያ',
'ጭልጋ',
'መተማ',
'ቋራ',
'አለፋ',
'ምዕራብ በለሳ',
'ምስራቅ በለሳ',
'ጎንደር'
'ፀለምት',
'ታች አርማጮ',
'ጣቁሳ','ዕብናት'
'ሊቦhምከም',
'ፎገራ',
'ፋርጣ',
'ላይ ጋይንት',
'ታች ጋይንት',
'ስማዳ',
'ምስራቅ እስቴ',
'ደራ',
'ደብረ ታቦር',
'ምዕራብ እስቴ','ቡግና',
'ቆቦ',
'ግዳን',
'መቄት',
'ዋድላ',
'ደላንታ',
'ጉባ ላፍቶ',
'ሃብሩ',
'ወልዲያ',
'ላስታ',
'ዳውንት','መቅደላ',
'ተንታ',
'ኩታበር',
'አምባሰል',
'ተሁለደሬ',
'ወረባቦ',
'አልቡኮ',
'ደሴ ዙሪያ',
'ለጋምቦ',
'ሳይንት',
'ደብረ ሲና',
'ከላላ',
'ጀማ',
'ወረኢሉ',
'ወግዴ',
'ኮምቦልቻ',
'ደሴ',
'መሐል ሳይንት',
'ለጋሒዳ','ሚዳ ወረሞ',
'መርሐቤቴ',
'ዕንሳሮ',
'ሞረትና ጅሩ',
'መንዝ ጌራ ምድር',
'ግሼ',
'አንጾ ኪያና ገምዛ'
'ኤፍራታና ግድም',
'መንዝ ማማ ምድር'
'ጣርማ በር',
'ሞጃና ዋደራ',
'ቀወት',
'አንጎለሳ ጠራና አሳግርት',
'አሳገርት',
'አንኮበር',
'ሃገረ ማርያምና ከሰም',
'በረኸት',
'ምንጃርና ሸንኮራ',
'ባሶና',
'ደብረ ብርሀን',
'መንዝ ቀያ ገብርኤል',
'መንዝ ላሎ ምድር',
'ሳያ ድብርና ዋዩ','ቢቡኝ',
'ሁለት እጅ እነሴ',
'ጎንቻ ሲሶ እነሴ',
'እነማይ',
'ደባይ ጥላትገን',
'ደብረ ኤሊያስ'
'ማቻከል',
'ጎዛምን',
'ባሶ ሊበን'
'አዋበል',
'እነብሴ ሳር ምድር',
'እናርጅ እናውጋ',
'ሸበል በረንታ','ደብረ ማርቆስ','ሲናን',
'አነደድ',
'ደጀን','ሰሜን አቸፈር',
'ባሕር ዳር ዙርያ',
'ይልማና ዴንሳ',
'ሜጫ', # check
'ሰከላ',
'ቋሪት',
'ደጋ ዳሞት'
'ጃቢ ተሕናን',
'ቡሬ',
'ወንበርማ',
'ጎንቻ',
'ደቡብ አቸፈር',
'ፍኖተ ሰላም',
'ደምበጫ','ዝቋላ',
'ደሀና',
'ጋዝግብላ',
'አበርገሌ',
'ሰቆጣ',
'ስሐላ','ዳንግላ',
'ባንጃ ሸኩዳድ',
'አንከሻ ጓጉሳ'
'ጓንጓ',
'ፉግታ ለኮማ',
'ጃዊ',
'ጓጉሳ ሺኩዳድ','ዳዋ ጨፋ',
'ባቲ',
'ጂሊ ጥሙጋ',
'አርጡማ ፉርሲ',
'ዳዊ ሐረዋ'
'ከሚሴ','አርጎባ','ባህር ዳር','መነሲቡ',
'ነጆ',
'ግምቢ',
'ላሎ አሳቢ',
'ኪልቱ ካራ',
'ቦጂ ዲርመጂ',
'ጉሊሶ',
'ጃርሶ',
'ኮንዳላ',
'ቦጂ ጨቆርሳ','ባቦ ጋምበል','ዩብዶ',
'ገንጂ',
'ሐሩ',
'ኖሌ ካባ',
'ቤጊ',
'ጊምቢ',
'ሰዮ ኖሊ',
'ሆማ',
 'አይራ','ሊሙ',
'ኢባንቱ',
'ጊዳ ኪረሙ',
'ሀሮ ሊሙ',
'ቦነያ ቡሺ',
'ዋዩ ጡቃ',
'ጉደያ ቢላ',
'ጎቡ ሰዮ',
'ሲዑ ሲሬ',
'ዲጋ',
'ሳሲጋ',
'ለካ ዱለቻ',
'ጉቶ ጊዳ',
'ጅማ አርጆ',
'ኑኑ ቁምባ',
'ዋማ ሀገሎ',
'ነቀምት' ,'ዳሪሙ',
'አለጌ ሳቺ',
'ዳቦ ሀና',
'ጮራ',
'ደጋ',
'አሌ',
'ጊቺ',
'ቦረቻ',
'ዴዴሳ',
'ያዩ',
'መቱ ዙሪያ',
'ቡሬ',
'ኖኖ ሰሌ'
'ቢቾ',
'ቢሎ ኖፋ'
'ሁሩሙ'
'ዲዱ',
'ማካ',
'ሁካ',
'መቱ'
'በደሌ',
'በደሌ ዙሪያ',
'ጨዋቃ',
'ዶሪኒ','ሊሙ ሰቃ',
'ሊሙ ኮሳ',
'ሶኮሩ',
'ጢሮ አፈታ',
'ቀርሳ',
'ማና',
'ጎማ',
'ጌራ',
'ሰቃ ጠቆርሳ',
'ዴዶ',
'ኦሞናዳ',
'ሲግሞ',
'ሰጠማ',
'ሸበ ሰንቦ',
'ጮራ ቦተራ'
'ጉማ',
'አጋሮ','ግንደበረት',
'ጀልዱ',
'አምቦ',
'ሚዳቀኝ',
'ጨሊያ',
'ባኮ ቲቤ',
'ዳኖ',
'ኖኖ',
'ጥቁር እጪኒ',
'ደንዲ',
'ኤጄሬ',
'ወልመራ',
'አድአ በርጋ',
'መታ ሮቢ',
'አምቦ',
'አቡና ግንደበረት',
'ቶኪ ኩታዩ',
'ጅባት',
'ኤልፋታ',
'ሆለታ','ወረ ጃርሶ',
'ደራ',
'ሂዳቡ አቦቴ',
'ኩዩ',
'ደገም',
'ግራር ጃርሶ',
'ደ/ሊባኖስ',
'ውጫሌና',
'አብቹና ኛ',
'ቅምብቢት',
'በረህ',
'ሱሉልታ',
'ፍቼ',
'ያያ ጉለሌ',
'ጅዳ',
'ሙሎ',
'አሌልቱ',
'ሰንዳፋ','ፈንታሌ',
'ቦሰት',
'አዳማ',
'ሎሜ',
'ግምቢቹ',
'አድአ',
'ዱግዳ',
'አዳሚ ቱሉና ጂዶ ኮምቦልቻ',
'ቢሾፍቱ',
'ቦራ',
'ሊበን',
'አቃቂ',
'ዝዋይ','መርቲ',
'አሰኮ',
'ጎሎልቻ',
'ዶዶታ',
 'ጀጁ',
'ዝዋይ ዱግዳ',
'ሂጦሳ',
'ሱዴ',
'ጮሌ',
'አሚኛ',
'ሴሩ',
'ሮቤ',
'ጠና',
 'ሽርካ',
'ዲገሉና ጢጆ',
'ጢዮ',
'ሙኔላ',
'ሊሙና ቢልቢሎ',
'ጉና',
'ሲሬ',
'ለሉዲ ሂጦሳ',#check
'ደክሲስ',
'ባሌ ጋሰጋር',
'ኢንከሉ ዋቢ',
'አሰላ','ሚኤሶ',
'ጡሎ',
'ዶባ,'
'መሰላ',
'ጭሮ',
'አንጫሮ',
'ጉባ ቆርቻ',
'ሃብሮ',
'ዳሮ ለቡ',
'ቁኒ',
'ቦኬ',
'ገመጪስ',
'ጭሮ ዙሪያ',
'በዴሳ', 'ኮምቦልቻ',
'ጃርሶ',
'ጉርሱም',
'ባቢሌ',
'ፈዲስ',
'ሃሮማያ',
'ኩርፋ ጨሌ',
'ቀርሳ',
'ሜታ',
'ጎሮ ጉቱ',
'ደደር',
'መልካ በሎ',
'በደኖ',
'ሚድጋ ቶላ',
'ጭናክሰን',
'ግራዋ',
'ጎላኦዳ',
'መዩ','አጋርፋ',
'ጎሎልቻ',
'ጋሰራ',
'ለገሂዳ',
'ጊኒር',
'ሲና',
'ጎባ',
'ሐረና ቡሉቅ',
'ዶሎ መና',
'መዳ ወላቡ',
'በርበሬ',
'ጉራዳሞሌ',
'ራይቱ',
'ሰወይና',
'ሮቤ',
'ጎባ',
'ዳዊ ቀጨን',
'ዲንሾ',
'ዳዊ ሲሬ','ቡሌ ሆራ',
'ያቤሎ',
'አሬሮ',
'ሞያሌ',
'ድሬ',
'ተልተሌ',
'አባያ',
'ዱግዳ ዳዋ',
'ሚዩ',
'ገላና','አመያ',
'ወንጪ',
'ወሊሶ',
'ኢሉ',
'ሰበታ ሀዋሳ', #check
'ቀርሳና ማሊማ',
'ቶሌ',
'በቾ',
'ሰደን ሶዳ',
'ወሊሶ',
'ጎሮ',
'ሶዶ ዳጫ',
'ሰበታ','ኡራጋ',
'ቦሬ',
'አዶላ',
'ዋደራ',
'ኦዶ ሻኪሶ',
'ቀርጫ',
'ሊበን',
'ዲማ',
'ሀምበላ ዋመና',
'ጊርጃ',
'ንገሌ',
'አዶላ','አዳማ','ጅማ','ሲራሮ',
'ሻላ',
'አርሲ ነገሌ',
'ኮፈሌ',
'ኮሬ',
'ግድብ አሳሳ',
'ዶዶላ',
'ኮኮሳ',
'ንንስቦ',
'አዳባ',
'ሻሽመኔ',
'ሻሽመነኔ ዙሪያ','ሀዋ ገላን',
'የማሎጊ ወለል',
'ዳሌ ዋበራ',
'ጋዎ ከቤ',
'ሰዮ',
'ደንቢ ዶሉ',
'አንፊሎ',
'ዳሌ ሳዲ',
'ጊዳሚ',
'ጅማ ሆሮ',
'ላሎ ኪሌ','ሆሮ',
'ሸአምቡ',
'ጉድሩ',
'ሀባቦ ጉድሩ',
'አበይ ጮመን',
'ጅማ ገንት',
'ጅማ ራሪ',
'ጃርድጋ ጃርቲ',
'አሙሩ',
'አቢ ዶንጎሮ','ቡራዩ','ኣይሻ',
'ደምበል',
'ሽንሌ',
'ኤረር',
'ሙሎ',
'ኣፍደም','ባቢሌ',
'ጉርሱም',
'ጅግጅጋ',
'ኣውበሬ',
'ቀብሪ በህያ',
'ሃርሺን','ደገሃመዶ',
'ደገሃቡር',
'ኣዋሬ',
'ጋሻሞ',
'ጉናጉዶ','ዳኖት',
'ቦህ',
'ገላዲን',
'ዋርዴር','ሸኮሽ',
'ቀብሪደሃር',
'ሽላቦ',
'ደበወይን','ሰለሐድ',
 'ፊቅ',
 'ገርቦ',
'ሃመሮ',
'ሰገግ',
'ድሁን',
'ለገሂዳ',
'መዩ ሙሉቅ','ለሊሚበሪ',
'አዳዲሎ',
'ደናን',
'ጎዴ',
'ቀላፎ',
'ሙስታሂል',
'ፌርፌር','ጉራዳሞሌ',
'ወይብ',
'ጎሮ በቅቅሳ',
'ሲረር',
'ምዕራብ እሚ'
'አፍቀር',
'ባሬ',
'ዶሎባይ',
'ቀርሳ ዱላ','ፊልቱ',
'ዶሎ ኦዶ',
'ሞያሌ',
'አዴት','ዳንጉር',
'ጉባ',
'ወምበራ',
'ማንዱራ',
'ድባጤ',
'ቡለን','መንጌ',
'ኩርሙክ',
'አሶሳ',
'ሽርቆሌ',
'ባምባሲ',
'ኦዳቡልዲ ጉሊ',
'ሆምሻ','ያሶ',
'ሲርባ አባይ',
'ካማሺ',
'አገሎ ሜጢ',
'በሎ ጀገንፎይ','ፓዌ','ማኦ ኮሞ','ቀቤና',
'አበሽግ',
'እዣ',
'ኮኪር ገደባኖ',
'መስቃን',
'ማረቆ',
'እደጋኝ',
'ጉመር',
'ቸፃ',
'እነሞርና ኤነር',
'ሞሕርና አክሊል',
'ጌታ',
'ወልቂጠ',
'ቡታጅራ','ሚሻ',
'ጊቤ',
'ሊሞ',
'ሻሻጎ',
'ምስራቅ ባዳዋቾ',
'ሶሮ',
'አናሊሞ',
'ምዕራብ ባዳዋቾ',
'ጎሚቦራ',
'ሆሳዕና','ጠምባሮ',
'አንጋጫ',
'ቀዲዳ ጋሜሳ',
'አላባ',
'ቃጫ ቢራ',
'ዶዮ ገና',
'ደኒቦያ',
'ዱራሜ','ሸበዲኖ',
'ሐዋሳ ዙሪያ',
'አርቤጎና',
'ዳሌ',
'አለታ ወንዶ',
'ዳራ',
'ሁላ',
'በንሳ',
'አሮሬሳ',
'ቦሪቻ',
'ጎርጪ',
'ማልጋ',
'ወንሾ',
'ሎኮ አበያ',
'ጨሪ',
'ቡርሳ',
'ቦና ዙሪያ',
'ወንዶ ገነት',
'ጨኮ','ወናጎ',
'ይርጋጨፌ',
'ኮችሬ',
'ቡሌ',
'ዲላ ዙሪያ',
'ገደብ',
'ዲላ','ቦሎሶ ሶሪ',
'ዳሞት ጋሌ',
'ዳሞት ወይዴ',
'ሁምቦ',
'ሶዶ ዙሪያ',
'ኪንዶ ኮይሻ',
'ኦፋ',
'ቦሎሶ ቦኒብ',
'ዳሞት ሶሪ',
'ኪንዶ ዲዳይ',
'ዳሞት ፉላሳ',
'ዱግና ፋኒጎ',
'ሶዶ','ሰላማጎ',
'ደቡብ አሪ',
'ሰሜን አሪ',
'ሀመር',
'ቤና ጸማይ',
'ዳሰነች',
'ማሌ',
'ኛጋቶም','ማሻ',
'አንደራቻ',
'የኪ','ሳይለም',
'ግሻ ደካ',
'ገዋታ',
'ጊንቦ',
'መንጅዎ',
'ጠሎ',
'ጨኖ',
'ዴቻ',
'ጨታ',
'ወና',
'ቢታ',
'ቦንጋ','መለኮዛ',
'ደኒቡ ጎፋ',
'ኩቻ',
'ቦረዳ',
'መምረብ አባያ',
'አርባምንች ዙሪያ',
'ጨንቻ',
'ዲታ',
'ደራማሎ'
'ዛላ',
'ኡባ ደብረ ፀሒይ',
'ከምባ',
'ቦንኬ',
'ገዝጎፋ',
'አይዳ',
'አርባ ምንጭ','ሰዉላ','ሸኮ',
'ጉራፈርዳ',
'ደቡብ ቤንች',
'ሻይ ቤንች',
'ሚኒት ጎልደያ',
'ሚኒት ሻሻ',
'ማጂ',
'በሮ',
'ሱርማ',
'ሰሜን ቤንች',
'ሚዛን አማን','የም'# ልዩ ወረዳ'
,'አማሮ'# ልዩ ዞን'
,'ቡርጂ','ኮንሶ',
'ዳስነች''ቶቻ',
'ማረካ',
'ሎማ',
'ገናቦሳ',
'ኢሳራ','ባስኬቶ', 'ኮንታ','አሊቾ ወሪሮ',
'ስልጢ',
'ለላንፉሮ',
'ምዕራብ አዘርነት',
'ዳሉቻ',
'ሳንኩራ',
'ምስራቅ አዘርነት',
'ውልባረግ','አላባ','ሐዋሳ','ጋምቤላ ዙሪያ',
'አቦቦ',
'ጎግ',
'ጆር',
'ዲማ',
'ጋምቤላ','ጂካዎ', 'ላር',
'ዋንታዋ',
'አኮቦ','ጎዳር', 'መንገሽ','ኢታግ','ሐረሪ', 'ሃረሪ','አዲስ አበባ','ድሬደዋ','ሞያሌ','አፍደም', 'መዳ ወሳቡ','ሞሎ',
'ንፋስ ስልክ ላፍቶ',
'ቦሌ',
'ልደታ',
'ቂርቆስ',
'የካ',
'አዲስ ከተማ',
'አራዳ',
'ጉለሌ',
'ኮልፌ ቀራኒዮ',
'አካኪ ቃሊቲ',
]
 
def subsector_dictionary():
    return ['የእንጨት እና የብረታ ብረት ስራ','አግሮ ፕሮሰሲንግ',
        "የግንባታ እቃዎች ማምረት",
        "ኬሚካል እና ኬሚካላዊ ምርቶች ይሠራሉ",
        'የቆዳ እና የቆዳ ምርቶች ማምረት',
        'ጨርቃ ጨርቅ እና ልብስ ስፌት','ያልተገለጸ ንዑስ ዘርፍ',
        'የእደ ጥበብ ውጤቶች','ጌጣጌጥ እና ማዕድን ውጤቶች ማምረት',
        'ከማኑፋክቸሪንግ ዘርፍ ውጪ','ማኑፋክቸሪንግ']

def expand_abbrevations(dictionary,abbrevation):
    abbrevation.split('/')[0]
    for val in dictionary:
        first_part = val.find(abbrevation.split('/')[0])
        last_part = val.find(abbrevation.split('/')[1])
        if first_part  != -1 and last_part != -1:
            if (first_part < last_part) and (first_part == 0):
                return val
    print("Not found in the dictionary")
    
def regex_mapper(col_type):
    def convert_case(match_obj):
    """
    convert abbrevation
    to numerical
    """
    if match_obj.group(1) and match_obj.group(2) is not None:
        return match_obj.group(1) + match_obj.group(2) + '00000'
    
    mapper_dict = {'association_type':{'\በግ.*|በገል.*|ግል.*|ግለ.*|ቨግል|በግለ': 'በግል',
    'አክሲዬን|share|የንድ ሽርክና|ኃላፊነቱ.*': 'ማህበር',
    'ህብረት ስራ መህብር|ፒኤልሲ|ሼር ካምፓኒ|ፒኤልሲ': 'ማህበር',
    '.*ግ.*': 'በግል',
    'በገል|በራስ': 'በግል',
    'Sol.*': 'private',
    '\Ó.*': 'unknown',
    'I.*': 'unknown',
    'ዘዘ|መብቃት|uunknown': 'unknown',
    'ገ/ገ|”unknown': 'unknown',
    ' አነስተኛ ': 'በግል',
    'Axion': 'unknown',
    'Uniyeenii|W.*|waldaa|S.*|s.*|E.*': 'ማህበር',
    'የለም|››': 'unknown',
    'በግል': 'private',
    'PLC|Family|ማህበር': 'association',
    'ታዳጊ': 'growing',
    'ብድር': 'loan'},
    'employee_count':{'\xa02',None},
    'capital':{'([0-9]+)(?:[.])([0-9]{3})(?: ሚ)',convert_case,
               '([0-9]+)(?: ሚ)':convert_case,
               'o':'0'}
    }
    return mapper_dict[col_type]

def map_with_regex(df_series,col_type):
    for pattern,val in regex_mapper(col_type).items():
        df_series.str.replace(f"r{pattern}", val, regex=True,inplace=True)
    return df_series
    
def replace_with_similar_phrase(dictionary,word):
    # check if there are any symbols if / found pass the word to
    # the expand abbrevation method if other symbols remove them
    # first check if the word can be found in the dictionary
    # if it is part of it, check letter by letter if all the letters
    # except the last one can be found in the dictionary
    # if not check the other way
    # if any of the above conditions 
    if word.find('/') != -1:
        if expand_abbrevations(dictionary,word):
            return expand_abbrevations(dictionary,word)
    word = ("").join([letter for letter in word if letter.isalnum()])
    print(word)
    for val in dictionary:
        val_new = ("").join(val.split(" "))
        if val_new.find(word) != -1 or word.find(val_new) != -1:
            return val
        else:
            if (val_new.find(word[:-1]) != -1) or (val_new.find(word[1:]) != -1):
                return val
        if difflib.SequenceMatcher(None, word, val_new).ratio() > 0.6:
            print("The value has similarity ratio above 0.6 returning ",val)
            return val
        

    
